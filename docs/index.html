<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Algoritmo ACV</title>
<style>
body { background:#0b132b; color:white; font-family:Arial; margin:0; padding:0; }
#app { padding:20px; max-width:600px; margin:auto; }
h1 { font-size:22px; margin-bottom:10px; }
p { font-size:16px; line-height:22px; }
button {
  display:block; width:100%; margin:8px 0; padding:14px;
  background:#5bc0be; border:none; border-radius:10px;
  color:#062925; font-size:16px; font-weight:bold; cursor:pointer;
}
button.header { background:#3a506b; color:white; width:auto; display:inline-block; margin-right:6px; }
.result { background:#1b3a4b; padding:16px; border-radius:12px; margin-top:14px; }
</style>
</head>
<body>
<div id="app"></div>

<script>
// ===================== ÁRBOL =====================
const ARBOL = {
  inicio: {
    title: "Estado de grandes vasos",
    body: "En pacientes con inicio de síntomas < 24 h",
    options: [
      { label: "Oclusión vaso proximal", next: "t1" },
      { label: "Oclusión basilar", next: "t2" },
      { label: "No hay oclusión de gran vaso", next: "t3" },
    ]
  },

  t1: { title: "Oclusión vaso proximal", body:"", options:[
    { label:"Wake up o inicio incierto", next:"perf1" },
    { label:"Síntomas < 6 horas", next:"nih6" },
    { label:"Entre 6-24 h, Rankin 3 o menor", next:"perf1" },
  ]},

  perf1:{ title:"Perfusión",
    body:"CBF <30%, mismatch >10 ml (IVT) / >15 ml (EVT).",
    options:[
      {label:"(+)", next:"final1"},
      {label:"(-)", next:"no"},
    ]
  },

  t2:{ title:"ACV despertar o <24h", options:[
    {label:"Sí", next:"nih2"},
    {label:"No", next:"no"},
  ]},

  nih2:{title:"Calcular NIH", options:[
    {label:"NIH < 6", next:"tromb1"},
    {label:"NIH 6-9", next:"tromb2"},
    {label:"NIH > 10", next:"tromb3"},
  ]},

  no:{title:"No es candidato a reperfusión", result:"No es candidato a reperfusión"},

  final1:{title:"Reperfusión",
    result:"Trombectomía mecánica si ASPECTS > 3. Trombólisis EV si síntomas > 9h."
  },

  tromb1:{title:"Reperfusión",
    result:"Trombolisis EV (<5h) + considerar trombectomía si fluctuante/deterioro."
  },
  tromb2:{title:"Reperfusión",
    result:"Trombolisis EV (<5h) + trombectomía si déficit invalidante."
  },
  tromb3:{title:"Reperfusión",
    result:"Trombolisis EV (<5h) + trombectomía mecánica."
  },

  // Ramas adicionales:
  t3:{title:"Tiempo inicio", options:[
    {label:"<6h", next:"tr4"},
    {label:">6h", next:"tr5"},
    {label:"Wake up <24h", next:"tr6"},
  ]},

  tr4:{title:"Reperfusión", result:"Trombolisis EV"},

  tr5:{title:"Síntomas >6h", options:[
    {label:"<9h", next:"perf2"},
    {label:">9h", next:"no"},
  ]},

  tr6:{title:"Tiempo incierto", options:[
    {label:"NIHS ≤4", next:"flair"},
    {label:"NIHS >4", next:"perf2"},
  ]},

  flair:{title:"FLAIR (RM)", options:[
    {label:"Muestra infarto", next:"no"},
    {label:"No muestra", next:"tr4"},
  ]},

  perf2:{title:"Perfusión", options:[
    {label:"(+)", next:"tr4"},
    {label:"(-)", next:"no"},
  ]},
};

// ===================== LÓGICA =====================
let current = "inicio";
let history = [];

function render(){
  const node = ARBOL[current];
  const app = document.getElementById("app");
  app.innerHTML = "";

  // Header
  const backBtn = document.createElement("button");
  backBtn.className="header";
  backBtn.textContent="Atrás";
  backBtn.disabled = history.length===0;
  backBtn.onclick=()=>{ current = history.pop(); render(); };

  const resetBtn = document.createElement("button");
  resetBtn.className="header";
  resetBtn.textContent="Reiniciar";
  resetBtn.onclick=()=>{ current="inicio"; history=[]; render(); };

  app.append(resetBtn, backBtn);

  // Título y texto
  app.insertAdjacentHTML("beforeend", `<h1>${node.title}</h1>`);
  if(node.body) app.insertAdjacentHTML("beforeend", `<p>${node.body}</p>`);

  // Resultado final
  if(node.result){
    app.insertAdjacentHTML("beforeend", `<div class="result"><p>${node.result}</p></div>`);
    return;
  }

  // Botones de opciones
  node.options.forEach(opt=>{
    const b = document.createElement("button");
    b.textContent = opt.label;
    b.onclick = ()=>{
      history.push(current);
      current = opt.next;
      render();
    };
    app.appendChild(b);
  });
}

render();
</script>
</body>
</html>
